<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Funcionários | EyesAnalytic</title>
    <!-- <link rel="stylesheet" href="../css/style.css"> -->
    <link rel="stylesheet" href="./css/pages/lista-funcionario-diretor.css">
    <link rel="stylesheet" href="./css/pages/aside-menu.css">
    <link rel="shortcut icon" href="./assets/svg/Logo.svg" type="image/x-icon">

</head>

<body onload="listarFuncionarios()">
    <aside id="aside-menu">
        <img src="./assets/svg/Logo.svg" alt="Logo" class="asideLogo">

        <ul id="navLinks">
            <a href="./lista-alertas.html" class="outros">
                <li>
                    <img src="./assets/svg/alert-svgrepo-com.svg" alt="Alerta">
                    <span>Alertas</span>
                </li>
            </a>

            <a href="./dashboard/dash-diretor.html" class="outros">
                <li>
                    <img src="./assets/svg/dashboard-svgrepo-com.svg" alt="Dashboard">
                    <span>Dashboard</span>
                </li>
            </a>

            <a href="./espec-servidores.html" class="outros">
                <li>
                    <img src="./assets/svg/servidor.svg" alt="Rede">
                    <span>Servidores</span>
                </li>
            </a>

            <a href="./funcionario-diretor.html" class="outros">
                <li>
                    <img src="./assets/svg/user-svgrepo-com.svg" alt="Usuário">
                    <span>Funcionários</span>
                </li>
            </a>

            <a href="./chamados-diretor.html" class="outros">
                <li>
                    <img src="./assets/svg/chamados.svg" alt="Chamados">
                    <span>Chamados</span>
                </li>
            </a>

            <a href="./index.html" class="sair-diretor">
                <li >
                    <img src="./assets/svg/exit-svgrepo-com.svg" alt="Saída">
                    <span>Sair</span>
                </li>
            </a>

        </ul>
        <div class="menu" id="menu-hamburguer">
            <div class="menu" id="menu-hamburguer">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="80px" height="10px"
                    class="hamburger-line">
                    <rect x="0" y="8" width="600" height="10" fill="white"></rect> <!-- Aumentar a altura aqui -->
                </svg>

                <!-- Linha 2 -->
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="80px" height="10px"
                    class="hamburger-line">
                    <rect x="0" y="24" width="600" height="10" fill="white"></rect> <!-- Aumentar a altura aqui -->
                </svg>

                <!-- Linha 3 -->
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="80px" height="10px"
                    class="hamburger-line">
                    <rect x="0" y="40" width="600" height="10" fill="white"></rect> <!-- Aumentar a altura aqui -->
                </svg>
            </div>

        </div>

        </div>
    </aside>
    <div id="fade" class="hide"></div>

    <main>

        <section class="funcionarios">
            <article class="lista" id="lista">
                <h2>Funcionários</h2>

                <!-- <div class="frameFuncionarios">
                    <div class="userImg">
                        <img src="./assets/svg/user.svg" alt="">
                    </div>
                    <p>Fernando Silva</p>
                    <p>Email: fernando.silva@email.com</p>
                    <p>Status: <span class="status-ativo">Ativo</span></p>
                </div>
                <div class="frameFuncionarios">
                    <div class="userImg">
                        <img src="./assets/svg/user.svg" alt="">
                    </div>
                    <p>Fernando Silva</p>
                    <p>Email: fernando.silva@email.com</p>
                    <p>Status: <span class="status-ativo">Ativo</span></p>
                </div>
                <div class="frameFuncionarios">
                    <div class="userImg">
                        <img src="./assets/svg/user.svg" alt="">
                    </div>
                    <p>Fernando Silva</p>
                    <p>Email: fernando.silva@email.com</p>
                    <p>Status: <span class="status-ativo">Ativo</span></p>
                </div>
                <div class="frameFuncionarios">
                    <div class="userImg">
                        <img src="./assets/svg/user.svg" alt="">
                    </div>
                    <p>Fernando Silva</p>
                    <p>Email: fernando.silva@email.com</p>
                    <p>Status: <span class="status-ativo">Ativo</span></p>
                </div>
                <div class="frameFuncionarios">
                    <div class="userImg">
                        <img src="./assets/svg/user.svg" alt="">
                    </div>
                    <p>Fernando Silva</p>
                    <p>Email: fernando.silva@email.com</p>
                    <p>Status: <span class="status-ativo">Ativo</span></p>
                </div>
                <div class="frameFuncionarios">
                    <div class="userImg">
                        <img src="./assets/svg/user.svg" alt="">
                    </div>
                    <p>Fernando Silva</p>
                    <p>Email: fernando.silva@email.com</p>
                    <p>Status: <span class="status-ativo">Ativo</span></p>
                </div> -->

            </article>

            <article class="cadastro">
                <a href="./cadastrar-funcionario.html"><button class="cadastroTecnico ">Cadastrar Técnico</button></a>
                <div class="card">
                    <h1>Fernando Silva</h1>
                    <hr>
                    <div>
                        <p>Email: fernando.silva@email.com</p>
                        <p>Senha: ************* </p>
                        <p>Status: <span class="status-ativo">Ativo</span></p>
                    </div>
                    <div class="buttons">
                        <button class="btn1" id="btnDesativar">Desativar</button>
                        <button class="btn2" id="btnAlterar">Alterar</button>
                    </div>
                </div>
            </article>


            <!-- Modal 1 (Desativar) -->
            <div id="modal1" class="modal">
                <div class="modal-content1">
                    <div class="modal-header1">
                        <h2>Desativar</h2>
                        <span class="close">&times;</span>
                    </div>
                    <div class="modal-body1">
                        <p><strong>Tem certeza que deseja desativar o perfil?</strong></p>
                    </div>
                    <div class="modal-footer1">
                        <button class="Mf1-Btn1">Cancelar</button>
                        <button class="Mf1-Btn2">Sim</button>

                    </div>
                </div>
            </div>


            <!-- Modal 2 (Alterar) -->
            <div id="modal2" class="modal">
                <div class="modal-content2">
                    <div class="modal-header2">
                        <h2>Fernando Silva</h2>
                        <span class="close">&times;</span>
                    </div>
                    <div class="modal-body2">
                        <label for="">Email:</label>
                        <input type="text" name="emailModal" id="UserEmail" placeholder="fernando.silva@email.com">
                        <label>Senha: </label>
                        <input type="password" name="senhaModal" id="UserSenha" placeholder="*************">
                    </div>
                    <div class="modal-footer2">
                        <button class="salvar-btn">Salvar</button>
                    </div>
                </div>
            </div>

        </section>

        <section class="chamados">
            <article class="alertas" id="chamadoCardapio">
                <h2>Chamados Recentes</h2>
                <div class="frameAlertas">
                    <div class="userImg">
                        <img src="./assets/svg/alerta.svg" alt="">
                    </div>
                    <p><span class="status-alerta">Alerta CPU</span></p>
                    <p>Status: <span class="status-ativo">Ativo</span></p>
                    <p>Responsável: Fernando Silva</p>
                    <div class="hrDt">
                        <p>12:13</p>
                        <p>20/09/2024</p>
                    </div>

                </div>
                <div class="frameAlertas">
                    <div class="userImg">
                        <img src="./assets/svg/alerta.svg" alt="">
                    </div>
                    <p><span class="status-alerta">Alerta CPU</span></p>
                    <p>Status: <span class="status-ativo">Ativo</span></p>
                    <p>Responsável: Fernando Silva</p>
                    <div class="hrDt">
                        <p>12:13</p>
                        <p>20/09/2024</p>
                    </div>

                </div>
                <div class="frameAlertas">
                    <div class="userImg">
                        <img src="./assets/svg/alerta.svg" alt="">
                    </div>
                    <p><span class="status-alerta">Alerta CPU</span></p>
                    <p>Status: <span class="status-ativo">Ativo</span></p>
                    <p>Responsável: Fernando Silva</p>
                    <div class="hrDt">
                        <p>12:13</p>
                        <p>20/09/2024</p>
                    </div>

                </div>

            </article>
        </section>
    </main>
</body>

</html>
<script>
    document.addEventListener("DOMContentLoaded", () => {
        const menuHamburguer = document.getElementById('menu-hamburguer');
        const navLinks = document.getElementById('navLinks');

        // Alterna a classe "active" no menu de navegação
        menuHamburguer.addEventListener('click', () => {
            navLinks.classList.toggle('active');
            menuHamburguer.classList.toggle('open');
        });

        // Função para abrir o modal específico
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        // Função para fechar o modal específico
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Abrir o modal de Desativar
        document.getElementById('btnDesativar').onclick = function () {
            openModal('modal1');
        };

        // Abrir o modal de Alterar
        document.getElementById('btnAlterar').onclick = function () {
            openModal('modal2');
        };

        // Fechar modais
        const closeButtons = document.querySelectorAll('.close');
        closeButtons.forEach(button => {
            button.onclick = function () {
                const modal = this.closest('.modal');
                modal.style.display = 'none';
            };
        });

        // Fechar ao clicar fora do modal
        window.onclick = function (event) {
            const modal1 = document.getElementById('modal1');
            const modal2 = document.getElementById('modal2');
            if (event.target === modal1) {
                closeModal('modal1');
            } else if (event.target === modal2) {
                closeModal('modal2');
            }
        };
    });

    function listarFuncionarios(){
    var idEmpresa = sessionStorage.FK_EMPRESA;
    var lista = document.getElementById("lista");
    fetch(`usuarios/listar/${idEmpresa}`, {
        method: "GET",
        headers: {
            "Content-Type": "application/json"
        }
    }).then(function(resposta){
        resposta.json().then(function(resposta){
            resposta.forEach(element => {
                let frameFuncionarios = document.createElement("div");
                frameFuncionarios.className = "frameFuncionarios";

                let userImg = document.createElement("div");
                userImg.className = "userImg"
                userImg.innerHTML = "<img src='./assets/svg/user.svg' alt=''>" 
                let nome = document.createElement("p");
                nome.innerHTML = element.nome;

                let email = document.createElement("p");
                email.innerHTML = "Email: "+ element.email;
                

                let status = document.createElement("p");
                status.innerHTML = "Status: ";
                let respostaStatus = document.createElement("span");
                respostaStatus.innerHTML = element.situacao;
                status.appendChild(respostaStatus);

                if (element.situacao === "ativo") {
                    respostaStatus.style.color = "green";
                } else if (element.situacao === "desativo") {
                    respostaStatus.style.color = "darkgray";
                }

                frameFuncionarios.appendChild(userImg);
                frameFuncionarios.appendChild(nome);
                frameFuncionarios.appendChild(email);
                frameFuncionarios.appendChild(status);
                lista.appendChild(frameFuncionarios);
            });
        });
    });
}
function listarChamados() {
        var dataAtual = new Date()
        var idDiretor = sessionStorage.ID_USUARIO
        fetch('/chamados/listarPorDiretor', {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                idDiretor: idDiretor
            })
        }).then(function (resposta) {
            resposta.json().then(function (resposta) {
                console.log("Dados encontrados:", resposta)
                resposta.forEach(element => {
                    var base = document.getElementById("chamadoCardapio")
                    var data = new Date(element.dtHora)
                    var dataDia = data.getDate()
                    var dataMes = data.getMonth()+1
                    var dataAno = data.getFullYear()
                    var dataHoras = data.getHours()
                    var dataMinutos = data.getMinutes()
                    var horas = `${adicionarZero(dataHoras)}:${adicionarZero(dataMinutos)}`
                    var date = `${adicionarZero(dataDia)}/${adicionarZero(dataMes)}/${adicionarZero(dataAno)}`

                    if(dataDia === dataAtual.getDate() && dataMes === dataAtual.getMonth()+1 && dataAno === dataAtual.getFullYear())
                {
                    base.appendChild(chamado)
                    var frameAlertas = document.createElement("div")
                    frameAlertas.className = "frameAlertas"
    
                }
            }
                );
            })
        })
            .catch(function (error) {
                console.log("#ERROR:", error)
            })
    }
    function adicionarZero(numero) {
        return (numero < 10 ? '0' : '') + numero;
    }



</script>